# üèóÔ∏è Infrastructure Architecture

Terraform-managed AWS serverless architecture with 153 resources across 6 specialized modules.

## Overall Architecture

![Full Infrastructure](picture/terraform/full_shot.svg)

**‚ñ≤ Complete infrastructure visualization generated by [Rover](https://github.com/im2nguyen/rover)**

---

## Module Breakdown

### 1. Network Resources

<img src="picture/terraform/network resources.png" width="600">

**VPC, Subnets, NAT Gateway, Internet Gateway, Route Tables**

- Multi-AZ setup for high availability
- Public/Private subnet isolation
- NAT Gateway for secure outbound traffic

### 2. Storage Resources

<img src="picture/terraform/storage resources.png" width="600">

**S3 Buckets, RDS PostgreSQL with pgvector**

- S3 for video frames and raw data
- RDS for structured analysis results and vector embeddings
- Automated backup and lifecycle policies

### 3. Security Resources

<img src="picture/terraform/security resources.png" width="600">

**Security Groups, Network ACLs**

- Least-privilege access control
- Port-specific ingress/egress rules
- VPC-level network isolation

### 4. Compute Resources

<img src="picture/terraform/compute resources.png" width="600">

**ECS Fargate, AWS Batch, GPU Compute Environment**

- Fargate for Django backend (serverless containers)
- Batch with g5.xlarge for GPU-accelerated AI analysis
- Auto-scaling based on job queue depth

### 5. Pipeline Resources

<img src="picture/terraform/pipeline resources.png" width="600">

**SQS, Lambda, EventBridge**

- SQS for async job queue
- Lambda for SQS ‚Üí Batch orchestration
- EventBridge for scheduled cleanup tasks

### 6. IAM Resources

<img src="picture/terraform/iam resources.png" width="600">

**Roles, Policies, Service-linked Permissions**

- Task execution roles for ECS/Batch
- Lambda execution roles with minimal permissions
- Cross-service trust relationships

---

## Key Features

- **100% Infrastructure as Code**: All resources defined in Terraform
- **Zero-Downtime Migration**: 200+ `moved` blocks for refactoring without resource destruction
- **Modular Design**: 6 independent modules for maintainability
- **Cost Optimized**: Pay-per-use serverless architecture (~$1-3/video vs $723/month EC2)

See [terraform/README.md](terraform/README.md) for detailed implementation guide.
