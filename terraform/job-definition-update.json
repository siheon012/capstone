{
  "jobDefinitionName": "capstone-dev-video-processor",
  "type": "container",
  "platformCapabilities": ["FARGATE"],
  "containerProperties": {
    "image": "287709190208.dkr.ecr.ap-northeast-2.amazonaws.com/capstone-dev-batch-processor:latest",
    "fargatePlatformConfiguration": {
      "platformVersion": "LATEST"
    },
    "resourceRequirements": [
      {
        "type": "VCPU",
        "value": "2"
      },
      {
        "type": "MEMORY",
        "value": "4096"
      }
    ],
    "executionRoleArn": "arn:aws:iam::287709190208:role/capstone-dev-batch-execution-role",
    "jobRoleArn": "arn:aws:iam::287709190208:role/capstone-dev-batch-task-role",
    "logConfiguration": {
      "logDriver": "awslogs",
      "options": {
        "awslogs-group": "/aws/batch/capstone-video-processor",
        "awslogs-region": "ap-northeast-2",
        "awslogs-stream-prefix": "batch"
      }
    },
    "environment": [
      {
        "name": "AWS_DEFAULT_REGION",
        "value": "ap-northeast-2"
      },
      {
        "name": "SQS_QUEUE_URL",
        "value": "https://sqs.ap-northeast-2.amazonaws.com/287709190208/capstone-dev-video-processing"
      },
      {
        "name": "S3_BUCKET_RAW",
        "value": "capstone-dev-raw"
      },
      {
        "name": "S3_BUCKET_THUMBNAILS",
        "value": "capstone-dev-thumbnails"
      },
      {
        "name": "FASTAPI_ENDPOINT",
        "value": "http://capstone-alb-175357648.ap-northeast-2.elb.amazonaws.com:8087"
      },
      {
        "name": "ENVIRONMENT",
        "value": "dev"
      }
    ],
    "secrets": [
      {
        "name": "POSTGRES_PASSWORD",
        "valueFrom": "arn:aws:secretsmanager:ap-northeast-2:287709190208:secret:capstone/db-password-bnNBe2"
      }
    ]
  },
  "retryStrategy": {
    "attempts": 3,
    "evaluateOnExit": [
      {
        "action": "RETRY",
        "onExitCode": "1"
      },
      {
        "action": "EXIT",
        "onExitCode": "0"
      }
    ]
  },
  "timeout": {
    "attemptDurationSeconds": 1800
  }
}
